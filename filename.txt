CREATE VIEW startsbefore AS
SELECT COUNT(id)
FROM Contract
GROUP BY bigpharma_id;
HAVING start_date < %s;

CREATE VIEW endsbefore AS
SELECT COUNT(id)
FROM Contract
GROUP BY bigpharma_id;
HAVING end_date < %s;


SELECT name FROM Patient
    WHERE age > (SELECT exp FROM Doctor WHERE Doctor.id=Patient.doctor_id);

SELECT name FROM Doctor
    WHERE (SELECT avg(age) FROM Patient WHERE Patient.doctor_id = Doctor.id) > 50;
